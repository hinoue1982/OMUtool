# \# JUSTDWH検査データ整理 説明書

対象バージョン: 0.2

# \# 使い方

REDCapから出してきたRecord_idおよび患者IDを含むワイドタイプのcsvファイル(症例データcsv)に、JUSTDWHから出してきたロングタイプのcsvファイル（検査データcsv)を、症例データの各レコードごとに基準日から指定した範囲のデータを検索・抽出し、連結するソフトウェアです。

# \# 画面構成

## :症例データ読み込み関連

データ連結の基準となる症例データファイル関連の領域です。ワイドデータを想定しています。

現時点ではcsvのみ読み込み可能です。

1行目：症例ファイルを指定するためのボタンです。csvに必要なカラムは以下のとおりです。

- Record_id：REDCapのレコードキー列です。重複禁止です。

- ID列：患者IDなど、各患者を識別するための列です。重複可です。

- データ収集基準日列：手術日や薬剤投与日など、データ収取範囲の基準とする日の列です。

ファイル読み込み後に以下の項目を指定してください。

２行目：検査データ側で患者を検索する基準となるID（患者ID等）が記載された列を選択指定してください。Record_id列でないことに注意してください。

３行目：データ収集の基準日となる列を選択指定してください。例:手術日、薬剤投与日など

**②**:検査データ読み込み関連

データ抽出元となる検査データファイル関連の領域です。ロングデータを想定しています。現時点ではcsvのみ読み込み可能です。

１行目：検査データファイルを指定するためのボタンです。

ファイル読み込み後に以下の項目を指定してください。

２行目：患者IDなど、各患者を識別するための列を指定してください。症例データ側と一致するものを抽出します。

３行目：検査施行日が入力された列を指定してください。

４行目：検査データの項目名が入力された列を指定してください。

５行目：検査データの結果が入力された列を指定してください。この列のデータが収集されます。

６行目：収集する検査データを指定してください。リストの中身は4行目で指定した列の内容になっています。

７行目：データ収集期間を指定してください。症例データ側のデータ基準日列を基準にこの行で指定した期間内の結果を収集します。基準日より前はマイナス（90日前は-90）、基準日より後はプラス(1週間後は 7)で指定します。例として手術の90日前から1日前のデータを収集する場合、-90と-1を2つのボックスに入力します。

**③**:データ収集・保存関連

１行目：保存したデータを連結する際の列名を入力してください。

例えば90日前から1日前のCEAなら　術前CEA　など

２行目：指定期間に複数回の検査があった場合の処理を選んでください。

現時点で選択できるのは

- 最も古い日付のデータ　か　最新のデータ　を抽出

> です。

３行目：データ収集を行うボタンです。ここまでの設定を変更しながら複数列を同時収集できます。

４行目：保存ボタンです。症例csvに収集したデータを新規列として横方向に連結したcsvを出力します。
